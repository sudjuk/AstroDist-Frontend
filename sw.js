importScripts("https://storage.googleapis.com/workbox-cdn/releases/7.0.0/workbox-sw.js");workbox.precaching.precacheAndRoute([{"revision":null,"url":"assets/index-5-gOW-yO.js"},{"revision":null,"url":"assets/index-D99ButM9.css"},{"revision":null,"url":"assets/index-DN3jx4Xi.js"},{"revision":"e3e099a33e8a2866d2f8123ca3315c0d","url":"asteroids.png"},{"revision":"0ae9509fc4d56a4db7b1f1b621553e81","url":"corzina.svg"},{"revision":"5d19bf19bba9274d4a0238aa5eb76184","url":"earth.png"},{"revision":"9d696fb37ac77142902a2b73e98c4997","url":"icon.svg"},{"revision":"cf8df35fcc5c2e86b2fca13a3bcb327c","url":"index.html"},{"revision":"a0145d2942283915d7d842a793cb5e1d","url":"manifest.webmanifest"},{"revision":"72f590a17ac00bab178fb2bc76cfa7c9","url":"registerSW.js"},{"revision":"9d696fb37ac77142902a2b73e98c4997","url":"icon.svg"},{"revision":"a0145d2942283915d7d842a793cb5e1d","url":"manifest.webmanifest"}]||[]);let i={apiBaseUrl:"http://localhost:8080",useTunnel:!1};self.addEventListener("activate",async()=>{try{const e=await fetch("/api-config.json");e.ok&&(i=await e.json(),console.log("Service Worker: API config loaded",i))}catch(e){console.warn("Service Worker: Failed to load api-config.json, using default",e)}});self.addEventListener("fetch",e=>{const s=new URL(e.request.url);let t=s.pathname;t.startsWith("/AstroDist-Frontend/")&&(t=t.replace("/AstroDist-Frontend","")),(t.startsWith("/api/")||t.startsWith("/order/")||t.startsWith("/static/"))&&e.respondWith((async()=>{try{const c=`${i.apiBaseUrl||"http://localhost:8080"}${t}${s.search}`;console.log("Service Worker intercepting:",s.pathname),console.log("Proxying to:",c);const a={method:e.request.method,headers:{},redirect:"follow"},l=["content-type","authorization","accept"];for(const r of l){const o=e.request.headers.get(r);o&&(a.headers[r]=o)}if(e.request.method!=="GET"&&e.request.method!=="HEAD")try{a.body=await e.request.clone().arrayBuffer()}catch{const o=await e.request.clone().text();o&&(a.body=o)}try{const r=await fetch(c,a);if(!r||r.status===0)throw new Error("Invalid response from backend");return r}catch(r){throw console.error("Fetch error details:",r),new Error(`Cannot connect to backend at ${c}. Make sure backend is running on localhost:8080. Error: ${r.message}`)}}catch(n){return console.error("Service Worker proxy error:",n,"URL:",s.pathname),new Response(JSON.stringify({error:"Proxy failed",message:n.message}),{status:503,statusText:"Service Unavailable",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*"}})}})())});
